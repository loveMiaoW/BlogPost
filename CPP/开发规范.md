# Google开源风格规范指南

>  规则的作用就是避免混乱。但规则本身一定要权威，有说服力，并且是理性的。

## 头文件

- 可以独立编译，以<b>.h</b> 为扩展名。需要被导入，但不属于头文件，以<b>.inc</b>为扩展名，避免使用。
- 使用`#define`，防止重复包含。格式为`<项目>_<路径>_<文件名>_H__`
- `#include` 中不应包含<b>.</b>/<b>..</b>。包含顺序：配套头文件，C语言系统库头文件，C++标准库头文件，其他库头文件，本项目头文件。空行分隔。

## 命名约定

>最重要的一致性规则是命名管理，命名的风格能让我们在不需要去查找类型声明的条件下快速地了解某个名字代表的含义：类型，变量，函数，常量，宏等等。

- 函数，变量，文件的命名要有描述性，少用缩写。
- 文件名要全部小写，可以包含_或者-。推荐使用下划线(__).
- 类/结构体，每个首字母大写，不能包含下划线。
- 变量和数据成员名一律小写。类成员变量下划线结尾。不区分静态和非静态。
- 常量，k开头，推荐全大写。
- 函数命名，大小写混合，取值和设值要求和变量名匹配。
- 命名空间，全部小写。
- 枚举命名，和常量以及宏一致，全部大写。

## 注释

- 注释风格

  // 或者/**/，统一就好。

- 文件注释

- 类注释

  每个类的定义都要附带一份注释, 描述类的功能和用法, 除非它的功能相当明显。

  ```c++
  // Iterates over the contents of a GargantuanTable.
  // Example:
  //    GargantuanTableIterator* iter = table->NewIterator();
  //    for (iter->Seek("foo"); !iter->done(); iter->Next()) {
  //      process(iter->key(), iter->value());
  //    }
  //    delete iter;
  class GargantuanTableIterator {
    ...
  };
  ```

  

- 函数注释

  函数声明处的注释描述函数功能; 定义处的注释描述函数实现。函数声明处注释的内容:

  - 函数的输入输出.

  - 对类成员函数而言: 函数调用期间对象是否需要保持引用参数, 是否会释放这些参数.

  - 函数是否分配了必须由调用者释放的空间.

  - 参数是否可以为空指针.

  - 是否存在函数使用上的性能隐患.

  - 如果函数是可重入的, 其同步前提是什么?

    ```c++
    // Returns an iterator for this table.  It is the client's
    // responsibility to delete the iterator when it is done with it,
    // and it must not use the iterator once the GargantuanTable object
    // on which the iterator was created has been deleted.
    //
    // The iterator is initially positioned at the beginning of the table.
    //
    // This method is equivalent to:
    //    Iterator* iter = table->NewIterator();
    //    iter->Seek("");
    //    return iter;
    // If you are going to immediately seek to another place in the
    // returned iterator, it will be faster to use NewIterator()
    // and avoid the extra seek.
    Iterator* GetIterator() const;
    ```

    

- TODO 注释

  对那些临时的, 短期的解决方案, 或已经够好但仍不完美的代码使用 `TODO` 注释。

  `TODO` 注释要使用全大写的字符串 `TODO`, 在随后的圆括号里写上你的名字, 邮件地址, bug ID, 或其它身份标识和与这一 `TODO` 相关的 issue。

  ```c++
  // TODO(kl@gmail.com): Use a "*" here for concatenation operator.
  // TODO(Zeke) change this to use relations.
  // TODO(bug 12345): remove the "Last visitors" feature.
  ```

## 格式

>每个人都有自己的编码风格，但如果一个项目中所有人都遵循同一种风格，这个项目就能更顺利的进行。

- 行长度不超过80。

- 尽量不使用非 ASCII 字符, 使用时必须使用 UTF-8 编码。

- 空格还是制表符？空格缩进，将制表格转化为空格。

- 函数声明与定义，返回类型和函数名在同一行, 参数也尽量放在同一行, 如果放不下就对形参分行, 分行方式与 [函数调用](https://zh-google-styleguide.readthedocs.io/en/latest/google-cpp-styleguide/formatting.html#function-calls) 一致。

  ```c++
  ReturnType ClassName::FunctionName(Type par_name1, Type par_name2) {
    DoSomething();
    ...
  }
  ReturnType LongClassName::ReallyReallyReallyLongFunctionName(
      Type par_name1,  // 4 space indent
      Type par_name2,
      Type par_name3) {
    DoSomething();  // 2 space indent
    ...
  }
  ```

## 结束

运用常识和判断力, 并且 *保持一致*.

编辑代码时, 花点时间看看项目中的其它代码， 并熟悉其风格. 如果其它代码中 `if` 语句使用空格, 那么你也要使用. 如果其中的注释用星号 (*) 围成一个盒子状, 那么你同样要这么做。

好了, 关于编码风格写的够多了; 代码本身才更有趣. 尽情享受吧!